<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>trhacknon Coil Builder</title>

<!-- SEO Basics -->
<meta name="description" content="trhacknon Coil Builder – Calculez facilement vos coils pour vape avec précision. Résistance, courant, puissance et export .cfg Arctic Fox.">
<meta name="keywords" content="coil, builder, vape, Kanthal, Nichrome, SS316L, Ni200, Titanium, DIY, Arctic Fox, profil, résistance, wattage, TC, VW">
<meta name="author" content="trhacknon">
<meta name="robots" content="index, follow">

<!-- Favicon -->
<link rel="icon" type="image/png" href="https://c.top4top.io/p_3561xlt3a1.jpg" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:title" content="trhacknon Coil Builder">
<meta property="og:description" content="Calculez facilement vos coils pour vape et exportez vos profils Arctic Fox. Résistance, courant, puissance et wraps estimés.">
<meta property="og:image" content="https://c.top4top.io/p_3561xlt3a1.jpg">
<meta property="og:url" content="https://coil-making.onrender.com/">
<meta property="og:site_name" content="trhacknon Coil Builder">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="trhacknon Coil Builder">
<meta name="twitter:description" content="Calculez facilement vos coils pour vape et exportez vos profils Arctic Fox. Résistance, courant, puissance et wraps estimés.">
<meta name="twitter:image" content="https://c.top4top.io/p_3561xlt3a1.jpg">
<meta name="twitter:url" content="https://coil-making.onrender.com/">
<meta name="twitter:creator" content="@trhacknon">

<!-- Other SEO / Social optional tags -->
<meta property="og:locale" content="en_US">
<meta property="og:image:alt" content="trhacknon Coil Builder preview image">
<meta name="theme-color" content="#fff000"> <!-- green for theme -->
<script src="https://cdn.tailwindcss.com"></script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-900 text-gray-100 font-sans">
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const materials = {
  'Kanthal A1': { rho: 1.45, note: 'Kanthal A1 (Wattage only, not for TC)'},
  'Nichrome (Ni80)': { rho: 1.09, note: 'Nichrome, high resistivity'},
  'SS316L': { rho: 0.75, note: 'Stainless Steel 316L — works with TC and VW'},
  'Ni200': { rho: 0.70, note: 'Nickel 200 — TC only, fragile'},
  'Titanium (Ti)': { rho: 0.42, note: 'Titanium — TC only, handle with care'}
};

const awgTable = {20:0.8128,22:0.6438,24:0.511,26:0.405,28:0.321,30:0.255,32:0.202};

function CoilBuilder(){
  const [material, setMaterial] = useState('SS316L');
  const [awg, setAwg] = useState(26);
  const [useAwg, setUseAwg] = useState(true);
  const [wireDia, setWireDia] = useState(awgTable[26]);
  const [wraps, setWraps] = useState(5);
  const [coilID, setCoilID] = useState(3);
  const [legs, setLegs] = useState(6);
  const [voltage, setVoltage] = useState(7.4);
  const [targetOhm, setTargetOhm] = useState(0.25);
  const [safetyAmp, setSafetyAmp] = useState(30);

  const canvasRef = useRef(null);
  const calcWireDia = useAwg ? awgTable[awg] : wireDia;

  const mmToMeters = x => x/1000;
  const area = d => Math.PI*Math.pow(d/2,2);
  const lengthM = (w, id, legs) => mmToMeters(Math.PI*id*w + legs);
  const computeResistance = (w) => (materials[material].rho * lengthM(w,coilID,legs)) / area(calcWireDia);

  // Mettre à jour le canvas à chaque changement
  useEffect(()=>{
    const canvas = canvasRef.current;
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.strokeStyle = '#34D399';
    ctx.lineWidth = 4;
    const centerX = canvas.width/2;
    const centerY = canvas.height/2;
    const radiusStep = 8;
    let currentRadius = 20;
    for(let i=0;i<wraps;i++){
      ctx.beginPath();
      ctx.arc(centerX, centerY, currentRadius, 0, Math.PI*2);
      ctx.stroke();
      currentRadius += radiusStep;
    }
  }, [wraps, coilID, legs, material, calcWireDia]);

  // Recalcul dynamique à chaque render
  const resistance = computeResistance(wraps);
  const current = voltage / resistance;
  const power = current * current * resistance;

  const targetResult = (() => {
    for(let i=1;i<=60;i++){
      const r = computeResistance(i);
      if(r >= targetOhm) return {wraps:i, resistance:r};
    }
    return {wraps:60, resistance:computeResistance(60)};
  })();

  function exportCFG(){
    const profile = {
      Name:'DAB-CUSTOM',
      Mode:(material==='SS316L' || material==='Ni200' || material.includes('Ti'))?'TC-SS':'Power',
      Temperature:material==='SS316L'?220:undefined,
      Power:Math.min(50,Math.round(power)),
      PreheatPower:Math.round(Math.min(80,Math.max(20,power*1.4))),
      PreheatTime:1,
      Cutoff:8,
      Resistance:resistance.toFixed(4)
    };
    let text='; Generated by trhacknon Coil Builder\n[ProfileCustom]\nName='+profile.Name+'\nMode='+profile.Mode+'\n';
    if(profile.Temperature) text+='Temperature='+profile.Temperature+'\n';
    text+='Power='+profile.Power+'\nPreheatPower='+profile.PreheatPower+'\nPreheatTime='+profile.PreheatTime+'\nCutoff='+profile.Cutoff+'\n; EstimatedResistance='+profile.Resistance+'\n';
    const blob=new Blob([text],{type:'text/plain'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;a.download='arcticfox-profile-dab.cfg';document.body.appendChild(a);a.click();a.remove();
  }

  return (
    <div className="p-8 max-w-6xl mx-auto">
      <h1 className="text-6xl font-extrabold text-purple-600 mb-10 text-center">trhacknon Coil Builder</h1>
      <div className="flex flex-col items-center mt-8">
  <div className="border-4 border-purple-500 rounded-2xl overflow-hidden shadow-[0_0_20px_rgba(128,0,255,0.7)] hover:scale-105 hover:shadow-[0_0_40px_rgba(128,0,255,0.9)] transition-transform duration-300">
    <img 
      src="https://b.top4top.io/p_3561x9nn70.jpeg" 
      alt="Luxotic DF200 Box" 
      className="block max-w-full h-auto"
    />
  </div>
  <div className="text-purple-400 font-bold text-xl mt-2">Luxotic DF200</div>
  <div className="text-purple-300 italic text-sm mt-1">With Custom Firmware ArcticFox</div>
</div>
      <div className="grid md:grid-cols-2 gap-8">

        <div className="p-6 bg-gray-800 rounded-2xl border border-green-800 shadow-inner">
          <h2 className="text-3xl font-bold mb-6 text-green-300 border-b border-green-500 pb-2">Inputs</h2>
          <label className="block mb-4">Material
            <select value={material} onChange={e=>setMaterial(e.target.value)} className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200">
              {Object.keys(materials).map(k=><option key={k} value={k}>{k} — {materials[k].note}</option>)}
            </select>
          </label>
          <label className="block mb-4"><input type="checkbox" checked={useAwg} onChange={e=>setUseAwg(e.target.checked)} className="mr-2 accent-green-400"/>Use AWG</label>
          {useAwg ? (
            <label className="block mb-4">AWG
              <select value={awg} onChange={e=>{setAwg(Number(e.target.value)); setWireDia(awgTable[Number(e.target.value)])}} className="w-full p-3 rounded bg-gray-900 border border-blue-700 hover:border-blue-500 transition duration-200">
                {Object.keys(awgTable).map(a=><option key={a} value={a}>AWG {a} — {awgTable[a]} mm</option>)}
              </select>
            </label>
          ):(
            <label className="block mb-4">Wire Ø (mm)
              <input type="number" value={wireDia} onChange={e=>setWireDia(Number(e.target.value))} step="0.01" className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200"/>
            </label>
          )}
          <label className="block mb-4">Wraps
            <input type="number" value={wraps} onChange={e=>setWraps(Number(e.target.value))} min={1} className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200"/>
          </label>
          <label className="block mb-4">Coil ID (mm)
            <input type="number" value={coilID} onChange={e=>setCoilID(Number(e.target.value))} step="0.1" className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200"/>
          </label>
          <label className="block mb-4">Legs (mm)
            <input type="number" value={legs} onChange={e=>setLegs(Number(e.target.value))} className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200"/>
          </label>
          <label className="block mb-4">Voltage (V)
            <input type="number" value={voltage} onChange={e=>setVoltage(Number(e.target.value))} step="0.1" className="w-full p-3 rounded bg-gray-900 border border-blue-700 hover:border-green-500 transition duration-200"/>
          </label>
          <label className="block mb-4">Target Ω
            <input type="number" value={targetOhm} onChange={e=>setTargetOhm(Number(e.target.value))} step="0.01" className="w-full p-3 rounded bg-gray-900 border border-green-700 hover:border-green-500 transition duration-200"/>
          </label>
        </div>

        <div className="p-6 bg-gray-800 rounded-2xl border border-yellow-800 shadow-inner">
          <h2 className="text-3xl font-bold mb-6 text-green-300 border-b border-blue-500 pb-2">Results</h2>
          <canvas ref={canvasRef} width={300} height={300} className="mb-4 mx-auto border border-blue-500 rounded"></canvas>
          <div className="mb-2">Wire Ø: <strong className="text-blue-600">{calcWireDia.toFixed(3)} mm</strong></div>
          <div className="mb-2">Estimated Resistance: <strong className="text-red-600">{resistance.toFixed(4)} Ω</strong></div>
          <div className="mb-2">Current:<strong className="text-red-600"> {current.toFixed(2)} A</strong> | Power: <strong className="text-red-600">{power.toFixed(2)} W</strong></div>
          <div className={`mb-2 ${current>safetyAmp?'text-red-600':'text-yellow-300'}`}>
            {current>safetyAmp?'⚠ Current exceeds safety limit':'Current within safe range'}
          </div>
          <div className="mt-4">
            <h3 className="text-green-300 font-bold mb-2">Target Resistance Estimate</h3>
            <div>{targetResult.wraps} wraps →<strong className="text-red-600"> {targetResult.resistance.toFixed(4)} Ω</strong></div>
          </div>
          <button onClick={exportCFG} className="mt-4 w-full p-3 rounded bg-pink-500 text-black font-bold hover:brightness-110 transition duration-200">
            Export Arctic Fox .cfg
          </button>
        </div>
      </div>
<div className="p-6 flex flex-col items-center mt-6 space-y-3  rounded-2xl border border-red-600 shadow-inner">
      <center><strong><h2 className="text-3xl font-bold mb-6 text-yellow-400 border-b border-blue-500 pb-2">Arcticfox & NFE Toolbox</h2></strong></center>
  <a 
    href="https://nfeteam.org/arcticfox/nightly/af_210103.bin" 
    target="_blank" 
    rel="noopener noreferrer"
    className="px-6 py-3 bg-blue-300 text-black font-bold rounded-2xl shadow-[0_0_20px_rgba(128,0,255,0.7)] hover:scale-105 hover:shadow-[0_0_40px_rgba(128,0,255,0.9)] transition-transform duration-300"
  >
    Download ArcticFox
  </a>
  <a 
    href="https://nfeteam.org/nfe-tools/NFE-Tools-v190703-21.46.zip" 
    target="_blank" 
    rel="noopener noreferrer"
    className="block mb-4 px-6 py-3 bg-purple-500 text-black font-bold rounded-2xl shadow-[0_0_20px_rgba(128,0,255,0.7)] hover:scale-105 hover:shadow-[0_0_40px_rgba(128,0,255,0.9)] transition-transform duration-300"
  >
    Download NFE Toolbox
  </a>
</div>
      <footer className="mt-8 text-center text-xs text-gray-400">
        Made with ♥ by <span className="text-red-600 font-bold">trhacknon</span>
      </footer>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<CoilBuilder />);
</script>
</body>
</html>
